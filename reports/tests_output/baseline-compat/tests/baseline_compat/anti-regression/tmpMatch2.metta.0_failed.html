<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"
>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"
>
<title></title>
<style type="text/css"
>
.ansi2html-content { display: inline; white-space: pre-wrap; word-wrap: break-word; }
.body_foreground { color: #AAAAAA; }
.body_background { background-color: #000000; }
.inv_foreground { color: #000000; }
.inv_background { background-color: #AAAAAA; }
.ansi1 { font-weight: bold; }
.ansi31 { color: #aa0000; }
.ansi32 { color: #00aa00; }
.ansi36 { color: #00aaaa; }
.ansi38-255165000 { color: #FFA500; }
.ansi38-255165000 { color: #FFA500; }
.ansi38-255165000 { color: #FFA500; }
.ansi38-255165000 { color: #FFA500; }
.ansi38-255165000 { color: #FFA500; }
.ansi38-255165000 { color: #FFA500; }
.ansi38-255165000 { color: #FFA500; }
.ansi38-255165000 { color: #FFA500; }
.ansi38-255165000 { color: #FFA500; }
.ansi38-255165000 { color: #FFA500; }
.ansi38-255165000 { color: #FFA500; }
.ansi38-255165000 { color: #FFA500; }
.ansi38-255165000 { color: #FFA500; }
.ansi38-255165000 { color: #FFA500; }
.ansi38-255165000 { color: #FFA500; }
.ansi38-013099040 { color: #0D6328; }
.ansi38-013099040 { color: #0D6328; }
.ansi38-255165000 { color: #FFA500; }
.ansi38-255165000 { color: #FFA500; }
.ansi38-255165000 { color: #FFA500; }
.ansi38-255165000 { color: #FFA500; }
.ansi38-255165000 { color: #FFA500; }
.ansi38-255165000 { color: #FFA500; }
.ansi38-255165000 { color: #FFA500; }
.ansi38-255165000 { color: #FFA500; }
.ansi38-255165000 { color: #FFA500; }
.ansi38-255165000 { color: #FFA500; }
.ansi38-255165000 { color: #FFA500; }
.ansi38-255165000 { color: #FFA500; }
.ansi38-255165000 { color: #FFA500; }
.ansi38-255165000 { color: #FFA500; }
.ansi38-255165000 { color: #FFA500; }
.ansi38-255165000 { color: #FFA500; }
.ansi38-255165000 { color: #FFA500; }
.ansi38-255165000 { color: #FFA500; }
.ansi38-255165000 { color: #FFA500; }
.ansi38-255165000 { color: #FFA500; }
.ansi38-255165000 { color: #FFA500; }
.ansi38-255165000 { color: #FFA500; }
.ansi38-255165000 { color: #FFA500; }
.ansi38-255165000 { color: #FFA500; }
.ansi38-255165000 { color: #FFA500; }
.ansi38-255165000 { color: #FFA500; }
.ansi38-255165000 { color: #FFA500; }
.ansi38-013099040 { color: #0D6328; }
.ansi38-255165009 { color: #FFA509; }
.ansi38-255238088 { color: #FFEE58; }
.ansi38-013099040 { color: #0D6328; }
.ansi38-255165000 { color: #FFA500; }
.ansi38-255165009 { color: #FFA509; }
.ansi38-255238088 { color: #FFEE58; }
.ansi38-013099040 { color: #0D6328; }
.ansi38-255165000 { color: #FFA500; }
.ansi38-255165009 { color: #FFA509; }
.ansi38-255238088 { color: #FFEE58; }
.ansi38-013099040 { color: #0D6328; }
.ansi38-255165000 { color: #FFA500; }
.ansi38-255165009 { color: #FFA509; }
.ansi38-255238088 { color: #FFEE58; }
.ansi38-013099040 { color: #0D6328; }
.ansi38-255165000 { color: #FFA500; }
.ansi38-255165000 { color: #FFA500; }
.ansi38-255165000 { color: #FFA500; }
.ansi38-255165000 { color: #FFA500; }
.ansi38-013099040 { color: #0D6328; }
.ansi38-255165000 { color: #FFA500; }
.ansi38-255165000 { color: #FFA500; }
.ansi38-255165000 { color: #FFA500; }
.ansi38-255165000 { color: #FFA500; }
.ansi38-255165000 { color: #FFA500; }
.ansi38-255165000 { color: #FFA500; }
.ansi38-255165000 { color: #FFA500; }
.ansi38-255165000 { color: #FFA500; }
.ansi38-255165000 { color: #FFA500; }
.ansi38-255165000 { color: #FFA500; }
</style>
</head>
<body class="body_foreground body_background" style="font-size: normal;" >
<pre class="ansi2html-content"
>
Script started on 2024-10-18 04:07:43+00:00 [TERM="xterm-256color" TTY="/dev/pts/0" COLUMNS="-1" LINES="-1"]
P;HTML|
;           (set_option_value  compat false)

P;HTML|
;           (set_option_value  compatio false)

P;HTML|
;           (set_option_value  src_indents false)

P;HTML|
;         (set_option_value  devel false)

P;HTML|
;         (set_option_value  stack-max 500)

P;HTML|
;         (set_option_value  limit inf)

P;HTML|
;         (set_option_value  initial-result-count 10)

P;HTML|
;         (set_option_value  answer-format show)

P;HTML|
;         (set_option_value  repeats true)

P;HTML|
;         (set_option_value  time true)

P;HTML|
;         (set_option_value  synth-unit-tests false)

P;HTML|
;         (set_option_value  optimize true)

P;HTML|
;         (set_option_value  transpiler silent)

P;HTML|
;          (set_debug  transpiler false)

P;HTML|
;         (set_option_value  compile false)

P;HTML|
;         (set_option_value  tabling auto)

P;HTML|
;         (set_option_value  log false)

P;HTML|
;         (set_option_value  output ./)

P;HTML|
;         (set_option_value  exeout ./Sav.gitlab.MeTTaLog)

P;HTML|
;         (set_option_value  halt false)

P;HTML|
;         (set_option_value  trace-length 500)

P;HTML|
;         (set_option_value  trace-on-overtime 4.0)

P;HTML|
;          (set_debug  overtime 4.0)

P;HTML|
;         (set_option_value  trace-on-overflow 1000)

P;HTML|
;          (set_debug  overflow 1000)

P;HTML|
;         (set_option_value  trace-on-eval false)

P;HTML|
;          (set_debug  eval false)

P;HTML|
;         (set_option_value  trace-on-load silent)

P;HTML|
;          (set_debug  load silent)

P;HTML|
;          (set_debug  trace-on-load false)

P;HTML|
;         (set_option_value  trace-on-exec false)

P;HTML|
;          (set_debug  exec false)

P;HTML|
;         (set_option_value  trace-on-error non-type)

P;HTML|
;          (set_debug  error non-type)

P;HTML|
;         (set_option_value  trace-on-fail false)

P;HTML|
;          (set_debug  fail false)

P;HTML|
;         (set_option_value  trace-on-test true)

P;HTML|
;          (set_debug  test true)

P;HTML|
;         (set_option_value  repl-on-error true)

P;HTML|
;         (set_option_value  repl-on-fail false)

P;HTML|
;         (set_option_value  exit-on-fail false)

P;HTML|
;         (set_option_value  repl auto)

P;HTML|
;         (set_option_value  prolog false)

P;HTML|
;         (set_option_value  exec noskip)

P;HTML|
;         (set_option_value  maximum-result-count inf)

P;HTML|
;         (set_option_value  html false)

P;HTML|
;         (set_option_value  python true)

P;HTML|
;         (set_option_value  trace-on-test false)

P;HTML|
;         (set_debug  test false)

P;HTML|
;         (set_option_value  trace-on-fail false)

P;HTML|
;         (set_debug  fail false)

P;HTML|
;         (set_option_value  load show)

P;HTML|
;         (set_option_value  test false)
P;HTML|
;          (is_cmd_option  prescan halt --halt=true true)
P;HTML|
;          (set_option_value  halt true)
P;HTML|
;          (is_cmd_option  prescan stdin --stdin=tty tty)
P;HTML|
;           (set_option_value  stdin tty)
P;HTML|
;          (is_cmd_option  prescan stdout --stdout=tty tty)
P;HTML|
;           (set_option_value  stdout tty)
P;HTML|
;          (is_cmd_option  prescan stderr --stderr=tty tty)
P;HTML|
;           (set_option_value  stderr tty)
P;HTML|
;          (set_option_value  compat false)
P;HTML|
;          (set_option_value  compatio false)
P;HTML|
;          (set_option_value  src_indents false)
P;HTML|
;          (set_option_value  devel false)
P;HTML|
;          (set_option_value  stack-max 500)
P;HTML|
;          (set_option_value  limit inf)
P;HTML|
;          (set_option_value  initial-result-count 10)
P;HTML|
;          (set_option_value  answer-format show)
P;HTML|
;          (set_option_value  repeats true)
P;HTML|
;          (set_option_value  time true)
P;HTML|
;          (set_option_value  synth-unit-tests false)
P;HTML|
;          (set_option_value  optimize true)
P;HTML|
;          (set_option_value  transpiler silent)
P;HTML|
;          (set_debug  transpiler false)
P;HTML|
;          (set_option_value  compile false)
P;HTML|
;          (set_option_value  tabling auto)
P;HTML|
;          (set_option_value  log false)
P;HTML|
;          (set_option_value  output ./)
P;HTML|
;          (set_option_value  exeout ./Sav.gitlab.MeTTaLog)
P;HTML|
;          (set_option_value  halt false)
P;HTML|
;          (set_option_value  trace-length 500)
P;HTML|
;          (set_option_value  trace-on-overtime 4.0)
P;HTML|
;          (set_debug  overtime 4.0)
P;HTML|
;          (set_option_value  trace-on-overflow 1000)
P;HTML|
;          (set_debug  overflow 1000)
P;HTML|
;          (set_option_value  trace-on-eval false)
P;HTML|
;          (set_debug  eval false)
P;HTML|
;          (set_option_value  trace-on-load silent)
P;HTML|
;          (set_debug  load silent)
P;HTML|
;          (set_debug  trace-on-load false)
P;HTML|
;          (set_option_value  trace-on-exec false)
P;HTML|
;          (set_debug  exec false)
P;HTML|
;          (set_option_value  trace-on-error non-type)
P;HTML|
;          (set_debug  error non-type)
P;HTML|
;          (set_option_value  trace-on-fail false)
P;HTML|
;          (set_debug  fail false)
P;HTML|
;          (set_option_value  trace-on-test true)
P;HTML|
;          (set_debug  test true)
P;HTML|
;          (set_option_value  repl-on-error true)
P;HTML|
;          (set_option_value  repl-on-fail false)
P;HTML|
;          (set_option_value  exit-on-fail false)
P;HTML|
;          (set_option_value  repl auto)
P;HTML|
;          (set_option_value  prolog false)
P;HTML|
;          (set_option_value  exec noskip)
P;HTML|
;          (set_option_value  maximum-result-count inf)
P;HTML|
;          (set_option_value  html false)
P;HTML|
;          (set_option_value  python true)
P;HTML|
;         (set_option_value  trace-on-test false)
P;HTML|
;          (set_debug  test false)
P;HTML|
;         (set_option_value  trace-on-fail false)
P;HTML|
;          (set_debug  fail false)
P;HTML|
;         (set_option_value  load show)
P;HTML|
;         (set_option_value  test true)
P;HTML|
;        (is_cmd_option  execute python --python=enable enable)
P;HTML|
;         (set_option_value  python enable)
P;HTML|
;        (is_cmd_option  execute timeout --timeout=40 40)
P;HTML|
;         (set_option_value  timeout 40)
P;HTML|
;         (is_cmd_option  execute output --output=./reports/tests_output/baseline-compat/ ./reports/tests_output/baseline-compat/)
P;HTML|
;         (set_option_value  output ./reports/tests_output/baseline-compat/)
P;HTML|
;         (is_cmd_option  execute html --html true)
P;HTML|
;          (set_option_value  html true)
P;HTML|
;         (is_cmd_option  execute test --test true)
P;HTML|
;          (set_option_value  test true)

; (load_metta_file  &self tests/baseline_compat/anti-regression/tmpMatch2.metta)
P;HTML|
;                       (track_load_into_file  /home/runner/work/metta-wam/metta-wam/tests/baseline_compat/anti-regression/tmpMatch2.metta)
P;HTML|
;                                        (load_answer_file  /home/runner/work/metta-wam/metta-wam/tests/baseline_compat/anti-regression/tmpMatch2.metta.answers /home/runner/work/metta-wam/metta-wam/tests/baseline_compat/anti-regression/tmpMatch2.metta)
P;HTML|
;                                         (= 1  "[()]")
P;HTML|
;                                         (= 2  "[()]")
P;HTML|
;                                         (= 3  "[()]")
P;HTML|
;                                         (= 4  "[()]")
P;HTML|
;                                         (= 5  "[()]")
P;HTML|
;                                         (= 6  "[()]")
P;HTML|
;                                         (= 7  "[()]")
P;HTML|
;                                         (= 8  "[(Error (assertEqualToResult (miner GroundingSpace-0x626f11d21ce8 (ms) (depth)) (() () () () () () () () () () (candidate (Inheritance (VarIdx Z) E) 2) (candidate (Inheritance (VarIdx Z) A) 2) (candidate (Inheritance B (VarIdx (S Z))) 1) (candidate (Inheritance C (VarIdx (S Z))) 2) (candidate (Inheritance D (VarIdx (S Z))) 1))) ")
P;HTML|
;                                         (= 8  "Expected: [(), (), (), (), (), (), (), (), (), (), (candidate (Inheritance (VarIdx Z) E) 2), (candidate (Inheritance (VarIdx Z) A) 2), (candidate (Inheritance B (VarIdx (S Z))) 1), (candidate (Inheritance C (VarIdx (S Z))) 2), (candidate (Inheritance D (VarIdx (S Z))) 1)]")
P;HTML|
;                                         (= 8  "Got: [(), (), (), (), (Error (get-candidate Z $link#78 1) NoValidAlternatives)]")
P;HTML|
;                                         (= 9  "Missed result: ())]")
P;HTML|
;                                         (= 9  "0.02user 0.00system 0:00.02elapsed 100%CPU (0avgtext+0avgdata 25088maxresident)k")
P;HTML|
;                                         (= 9  "0inputs+0outputs (0major+2940minor)pagefaults 0swaps")
P;HTML|
;                                        (load_answer_file  /home/runner/work/metta-wam/metta-wam/tests/baseline_compat/anti-regression/tmpMatch2.metta.answers /home/runner/work/metta-wam/metta-wam/tests/baseline_compat/anti-regression/tmpMatch2.metta)

;;;;;;;;;;;
;;;; Nat ;;
;;;;;;;;;;;
;;;; Define Nat
<span class="ansi38-255165000"
> (: Nat Type)
</span><span class="ansi38-255165000"
> (: Z Nat)
</span><span class="ansi38-255165000"
> (: S (-> Nat Nat))
</span>;;;; Define <=
<span class="ansi38-255165000"
> (: <= (-> $a $a Bool))
</span><span class="ansi38-255165000"
> (= (<= $x $y) (or (< $x $y) (== $x $y)))
</span>;;;; Define cast functions between Nat and Number
<span class="ansi38-255165000"
> (: fromNumber (-> Number Nat))
</span><span class="ansi38-255165000"
> (= (fromNumber $n) (if (<= $n 0) Z (S (fromNumber (- $n 1)))))
</span><span class="ansi38-255165000"
> (: fromNat (-> Nat Number))
</span><span class="ansi38-255165000"
> (= (fromNat Z) 0)
</span><span class="ansi38-255165000"
> (= (fromNat (S $k)) (+ 1 (fromNat $k)))
</span>;;;; Define max
<span class="ansi38-255165000"
> (: max (-> $a $a $a))
</span><span class="ansi38-255165000"
> (= (max $x $y) (if (> $x $y) $x $y))
</span>;;;; Define min
<span class="ansi38-255165000"
> (: min (-> $a $a $a))
</span><span class="ansi38-255165000"
> (= (min $x $y) (if (< $x $y) $x $y))
</span>;;;; Tuple count grounded python function
;;;;!(extend-py! ../utils/helper.py)
;;;; This is very slow, use the grounded python function instead
<span class="ansi38-255165000"
> (= (tuple-count $tuple) (if (== $tuple ()) 0 (+ 1 (tuple-count (cdr-atom $tuple)))))
</span><span class="ansi38-013099040"
>!(bind! &specializations (new-space))

</span>[

Deterministic: ()
()]
<span class="ansi38-013099040"
>!(bind! &abstractions (new-space))

</span>[

Deterministic: ()
()]
;;;; Initialization
<span class="ansi38-255165000"
> (= (init-miner $db $msup $highsurp) (superpose ((extract-valuation $db) (add-atom &self (= (refdb) $db)) (add-atom &self (= (msNat) (fromNumber $msup))) (add-atom &self (= (highsurp) $highsurp)) (get-universe-size $db))))
</span><span class="ansi38-255165000"
> (= (init-miner $db $msup $highsurp $target-link) (superpose ((extract-valuation $db $target-link) (add-atom &self (= (refdb) $db)) (add-atom &self (= (msNat) (fromNumber $msup))) (add-atom &self (= (highsurp) $highsurp)) (get-universe-size $db))))
</span>;;;; Search for Triplets in DB 
;;;; collect valuation sets and generate specializations
<span class="ansi38-255165000"
> (= (extract-valuation $db) (match $db ($link $x $y) (superpose ((build-specialization ($link $x (VarIdx (S Z)))) (build-specialization ($link (VarIdx Z) $y)) (add-abstractions ($link (VarIdx Z) (VarIdx (S Z))))))))
</span>;;;; Given target link
<span class="ansi38-255165000"
> (= (extract-valuation $db $target-link) (match $db ($target-link $x $y) (superpose ((build-specialization ($target-link $x (VarIdx (S Z)))) (build-specialization ($target-link (VarIdx Z) $y))))))
</span><span class="ansi38-255165000"
> (= (build-specialization $sp) (case (match &specializations $sp $sp) ((%void% (add-atom &specializations $sp)))))
</span><span class="ansi38-255165000"
> (= (add-abstractions $aptrn) (case (match &abstractions $aptrn $aptrn) ((%void% (add-atom &abstractions $aptrn)))))
</span>;;;; Get unique links
<span class="ansi38-255165000"
> (= (get-links) (match &abstractions ($link $x $y) $link))
</span>;;;; Get abstract patterns
<span class="ansi38-255165000"
> (= (abstract-patterns) (match &abstractions $aptrn $aptrn))
</span>;;;; Specialize a pattern
<span class="ansi38-255165000"
> (= (specialize $link) (match &specializations ($link $x $y) ($link $x $y)))
</span>;;;; all Specializations
<span class="ansi38-255165000"
> (= (all-specialization) (match &specializations $x $x))
</span>;;;; Todo: implement Debruijn index
;;;; Define DeBruijn Index
<span class="ansi38-255165000"
> (: DeBruijn Type)
</span><span class="ansi38-255165000"
> (: VarIdx (-> Nat DeBruijn))
</span><span class="ansi38-255165000"
> (= (fromDeb $pattern $Xvar $Yvar) (case ((get-metatype $pattern) $pattern) (((Variable $) $pattern) (($ $pattern) (let ($link $a $b) $pattern (case ($link (get-type $a) (get-type $b)) ((($link DeBruijn %Undefined%) ($link $Xvar $b)) (($link %Undefined% DeBruijn) ($link $a $Yvar)) (($link DeBruijn DeBruijn) ($link $Xvar $Yvar)) ($ $pattern))))) ($ $pattern))))
</span><span class="ansi38-255165000"
> (= (fromDebruijn $ptrn $Xvar $Yvar) (case $ptrn (((, $p1 $p2) (, (fromDeb $p1 $Xvar $Yvar) (fromDeb $p2 $Xvar $Yvar))) ((, $p1 $p2 $p3) (, (fromDeb $p1 $Xvar $Yvar) (fromDeb $p2 $Xvar $Yvar) (fromDeb $p3 $Xvar $Yvar))) ($ (fromDeb $ptrn $Xvar $Yvar)))))
</span>;;; Count the number of instances of a given pattern
<span class="ansi38-255165000"
> (= (count $pattern) (let $result (case (match &self (= (refdb) $db) $db) (($db (let $dptrn (fromDebruijn $pattern $Xvar $Yvar) (collapse (match $db $dptrn $dptrn)))) (%void% ()))) (tuple-count $result)))
</span><span class="ansi38-255165000"
> (= (countNat $pattern) (fromNumber (count $pattern)))
</span>;;;; Return candidate patterns in the format (candidate pattern count) 
;;;; for patterns with a support value >= the minimum support.
;;;; the count here will later be used for calculating surprisingness.
<span class="ansi38-255165000"
> (= (support $pattern $minsup) (let $cnt (count $pattern) (if (> (+ $cnt 1) $minsup) (candidate $pattern $cnt) (superpose ()))))
</span>;;;; Extract a pattern from a Candidate pattern of form
;;;; (candidate pattern count)
<span class="ansi38-255165000"
> (= (get-pattern $cnpattern) (let (candidate $pattern $cnt) $cnpattern $pattern))
</span>;;;; flatten combination
;;;; TODO: apply reduction rule
<span class="ansi38-255165000"
> (= (flatten $pattern) (case $pattern (((, (, $a $b) $c) (, $a $b $c)) ((, $a (, $b $c)) (, $a $b $c)) ($ $pattern))))
</span>;;;; Get universe size of a given db
<span class="ansi38-255165000"
> (= (get-universe-size $dbspace) (add-atom &self (= (universe-size) (let $u (collapse (match $dbspace $x 1)) (tuple-count $u)))))
</span>;;;; Probability formula
<span class="ansi38-255165000"
> (= (prob $count) (/ $count (universe-size)))
</span>;;;; iSurprisingness formula
<span class="ansi38-255165000"
> (= (iSurprisingness $pattern) (case $pattern (((candidate (, $p1 $p2) $cnt) (let* (($pp1 (prob (count $p1))) ($pp2 (prob (count $p2))) ($p1p2 (* $pp1 $pp2)) ($p (prob $cnt))) (/ (max (- $p $p1p2) (- $p1p2 $p)) $p))) ((candidate (, $p1 $p2 $p3) $cnt) (let* (($pp1 (prob (count $p1))) ($pp2 (prob (count $p2))) ($pp3 (prob (count $p3))) ($pp1p2 (prob (count (, $p1 $p2)))) ($pp1p3 (prob (count (, $p1 $p3)))) ($pp2p3 (prob (count (, $p2 $p3)))) ($maxP (max (* $pp1p2 $pp3) (max (* $pp1p3 $pp2) (max (* $pp2p3 $pp1) (* $pp1 (* $pp2 $pp3)))))) ($minP (min (* $pp1p2 $pp3) (min (* $pp1p3 $pp2) (min (* $pp2p3 $pp1) (* $pp1 (* $pp2 $pp3)))))) ($p (prob $cnt))) (/ (max (- $p $maxP) (- $minP $p)) $p))) ($ 0))))
</span>;;;; probability estimate 
;;;; empirical
;;;; probability estimate
;;;; empirical
<span class="ansi38-255165000"
> (= (isurp? ($ptrn $cnt)) (if (> (iSurprisingness (candidate $ptrn $cnt)) (highsurp)) true false))
</span>;;;; MeTTa port of pattern miner, using match.
;;;; Given a collection of data trees db, a minimum support ms and an
;;;; initial collection of patterns Candidate (containing at least the identity
;;;; pattern), the pattern mining algorithm works as follows
;;;; 1. Select a pattern P from C
;;;; 2. Extract the valuation set of P over db, called V
;;;; 3. Determine the shallow abstractions of V, called A
;;;; 4. Specialize P by composing it with elements in A
;;;; 5. Add the resulting specializations with enough support in C,
;;;;    discard the others
;;;; 6. Repeat till termination
;;;; Import utils
;;; !(import! &self ../utils/MinerUtils.metta)
;;;; Get candidate patterns depth zero
<span class="ansi38-255165000"
> (= (get-candidate Z $linkType $ms) (let $sp (specialize $linkType) (support $sp $ms)))
</span>;;;; Get candidate patterns depth n. (maximum is three)
<span class="ansi38-255165000"
> (= (get-candidate (S $k) $linkType $ms) (let $comb (, (get-pattern (get-candidate $k $linkType $ms)) (get-pattern (get-candidate Z $linkType $ms))) (support (flatten $comb) $ms)))
</span>;;;; Frequent patterns Miner
<span class="ansi38-255165000"
> (= (miner $db $ms $depth) (superpose ((init-miner $db $ms $highsurp) (let $link (get-links) (get-candidate $depth $link $ms)))))
</span>;;;; Surprising patterns miner
<span class="ansi38-255165000"
> (= (miner-surprising $db $ms $depth $highsurp) (let* (($cptrn (miner $db $ms $depth)) ($isurp (iSurprisingness $cptrn))) (if (> $isurp $highsurp) (surp (get-pattern $cptrn) $isurp) (superpose ()))))
</span>;;; !(import! &self MinerMatch.metta)
;;;; Load sample data
;;; !(import! &db ../data/sample.metta)
<span class="ansi38-013099040"
>!(bind! &db (new-space))

</span>[

Deterministic: ()
()]
<span class="ansi38-255165009"
>;; In file as:  
</span><span class="ansi1 ansi38-255238088"
>!(add-atom &db (Inheritance B A))
</span>;; To unit test case:
<span class="ansi38-013099040"
>!(assertEqualToResult (add-atom &db (Inheritance B A)) (()))

</span>[

;<h3 id="ANTI-REGRESSION.TMPMATCH2.01"
>;; ANTI-REGRESSION.TMPMATCH2.01</h3>
<span class="ansi38-255165000"
> (Inheritance B A)
</span>; 
; EVAL TEST
; took 0.002 secs. (1.99 milliseconds) 

!(assertEqualToResult (add-atom &db (Inheritance B A)) (()))

<span class="ansi36"
>(loonit_success  (equal_enough_for_test  (()) (())))
</span>
Deterministic: ()
()]
<span class="ansi38-255165009"
>;; In file as:  
</span><span class="ansi1 ansi38-255238088"
>!(add-atom &db (Inheritance C A))
</span>;; To unit test case:
<span class="ansi38-013099040"
>!(assertEqualToResult (add-atom &db (Inheritance C A)) (()))

</span>[

;<h3 id="ANTI-REGRESSION.TMPMATCH2.02"
>;; ANTI-REGRESSION.TMPMATCH2.02</h3>
<span class="ansi38-255165000"
> (Inheritance C A)
</span>; 
; EVAL TEST
; took 0.002 secs. (1.93 milliseconds) 

!(assertEqualToResult (add-atom &db (Inheritance C A)) (()))

<span class="ansi36"
>(loonit_success  (equal_enough_for_test  (()) (())))
</span>
Deterministic: ()
()]
<span class="ansi38-255165009"
>;; In file as:  
</span><span class="ansi1 ansi38-255238088"
>!(add-atom &db (Inheritance D E))
</span>;; To unit test case:
<span class="ansi38-013099040"
>!(assertEqualToResult (add-atom &db (Inheritance D E)) (()))

</span>[

;<h3 id="ANTI-REGRESSION.TMPMATCH2.03"
>;; ANTI-REGRESSION.TMPMATCH2.03</h3>
<span class="ansi38-255165000"
> (Inheritance D E)
</span>; 
; EVAL TEST
; took 0.002 secs. (1.94 milliseconds) 

!(assertEqualToResult (add-atom &db (Inheritance D E)) (()))

<span class="ansi36"
>(loonit_success  (equal_enough_for_test  (()) (())))
</span>
Deterministic: ()
()]
<span class="ansi38-255165009"
>;; In file as:  
</span><span class="ansi1 ansi38-255238088"
>!(add-atom &db (Inheritance C E))
</span>;; To unit test case:
<span class="ansi38-013099040"
>!(assertEqualToResult (add-atom &db (Inheritance C E)) (()))

</span>[

;<h3 id="ANTI-REGRESSION.TMPMATCH2.04"
>;; ANTI-REGRESSION.TMPMATCH2.04</h3>
<span class="ansi38-255165000"
> (Inheritance C E)
</span>; 
; EVAL TEST
; took 0.001 secs. (1.40 milliseconds) 

!(assertEqualToResult (add-atom &db (Inheritance C E)) (()))

<span class="ansi36"
>(loonit_success  (equal_enough_for_test  (()) (())))
</span>
Deterministic: ()
()]
;;;; Parameters
<span class="ansi38-255165000"
> (= (ms) 1)
</span>;;;; Max depth (number of conjuncts) is 3
;;;; it starts from 0, 
<span class="ansi38-255165000"
> (= (depth) (fromNumber 0))
</span>;;; (= (depth) (fromNumber 1))
;;; (= (depth) (fromNumber 2))
<span class="ansi38-255165000"
> (= (highsurp) 0.8)
</span>;;; !(miner &db (ms) (depth))
;;;; frequent patterns 
<span class="ansi38-013099040"
>!(assertEqualToResult (miner &db (ms) (depth)) (() () () () () () () () () () (candidate (Inheritance (VarIdx Z) E) 2) (candidate (Inheritance (VarIdx Z) A) 2) (candidate (Inheritance B (VarIdx (S Z))) 1) (candidate (Inheritance C (VarIdx (S Z))) 2) (candidate (Inheritance D (VarIdx (S Z))) 1)))

</span>[

;<h3 id="ANTI-REGRESSION.TMPMATCH2.05"
>;; ANTI-REGRESSION.TMPMATCH2.05</h3>
<span class="ansi38-255165000"
> (Inheritance B (VarIdx (S Z)))
</span><span class="ansi38-255165000"
> (Inheritance (VarIdx Z) A)
</span><span class="ansi38-255165000"
> (Inheritance (VarIdx Z) (VarIdx (S Z)))
</span><span class="ansi38-255165000"
> (Inheritance C (VarIdx (S Z)))
</span><span class="ansi38-255165000"
> (Inheritance D (VarIdx (S Z)))
</span><span class="ansi38-255165000"
> (Inheritance (VarIdx Z) E)
</span><span class="ansi38-255165000"
> (= (refdb) &db)
</span><span class="ansi38-255165000"
> (= (msNat) (fromNumber 1))
</span><span class="ansi38-255165000"
> (= (highsurp) $_481272)
</span><span class="ansi38-255165000"
> (= (universe-size) (let $_734326 (collapse (match &db $_734362 1)) (tuple-count $_734326)))
</span>; 
; EVAL TEST
; took 0.126 secs. (125.59 milliseconds) 

!(assertEqualToResult (miner &db (ms) (depth)) (() () () () () () () () () () (candidate (Inheritance (VarIdx Z) E) 2) (candidate (Inheritance (VarIdx Z) A) 2) (candidate (Inheritance B (VarIdx (S Z))) 1) (candidate (Inheritance C (VarIdx (S Z))) 2) (candidate (Inheritance D (VarIdx (S Z))) 1)))

<span class="ansi36"
>(loonit_success  (equal_enough_for_test  (() () () () () () () () () () () () () () () () (candidate (Inheritance B (VarIdx (S Z))) 1) (candidate (Inheritance (VarIdx Z) A) 2) (candidate (Inheritance C (VarIdx (S Z))) 2) (candidate (Inheritance D (VarIdx (S Z))) 1) (candidate (Inheritance (VarIdx Z) E) 2)) (() () () () () () () () () () (candidate (Inheritance (VarIdx Z) E) 2) (candidate (Inheritance (VarIdx Z) A) 2) (candidate (Inheritance B (VarIdx (S Z))) 1) (candidate (Inheritance C (VarIdx (S Z))) 2) (candidate (Inheritance D (VarIdx (S Z))) 1))))
</span>
Deterministic: ()
()]
<span class="ansi32"
>% 1,367,276 inferences, 0.271 CPU in 0.271 seconds (100% CPU, 5041787 Lips)
</span>P;HTML|
;                       (= /home/runner/work/metta-wam/metta-wam/tests/baseline_compat/anti-regression/tmpMatch2.metta  0)
<span class="ansi1"
>LoonIt Report
</span>------------
<span class="ansi32"
>Successes: 5
</span><span class="ansi32"
>Failures: 0
</span><br/> <a href="#" onclick="window.history.back(); return false;"
>Return to summaries</a><br/>
P;HTML|
;         (is_cmd_option  execute halt --halt=true true)
P;HTML|
;          (set_option_value  halt true)
P;HTML|
;          (is_cmd_option  execute stdin --stdin=tty tty)
P;HTML|
;          (set_option_value  stdin tty)
P;HTML|
;          (is_cmd_option  execute stdout --stdout=tty tty)
P;HTML|
;           (set_option_value  stdout tty)
P;HTML|
;          (is_cmd_option  execute stderr --stderr=tty tty)
P;HTML|
;           (set_option_value  stderr tty)
P;HTML|
;         (set_option_value  compat false)
P;HTML|
;         (set_option_value  compatio false)
P;HTML|
;         (set_option_value  src_indents false)
P;HTML|
;         (set_option_value  devel false)
P;HTML|
;         (set_option_value  stack-max 500)
P;HTML|
;         (set_option_value  limit inf)
P;HTML|
;         (set_option_value  initial-result-count 10)
P;HTML|
;         (set_option_value  answer-format show)
P;HTML|
;         (set_option_value  repeats true)
P;HTML|
;         (set_option_value  time true)
P;HTML|
;         (set_option_value  synth-unit-tests false)
P;HTML|
;         (set_option_value  optimize true)
P;HTML|
;         (set_option_value  transpiler silent)
P;HTML|
;          (set_debug  transpiler false)
P;HTML|
;         (set_option_value  compile false)
P;HTML|
;         (set_option_value  tabling auto)
P;HTML|
;         (set_option_value  log false)
P;HTML|
;         (set_option_value  output ./)
P;HTML|
;         (set_option_value  exeout ./Sav.gitlab.MeTTaLog)
P;HTML|
;         (set_option_value  halt false)
P;HTML|
;         (set_option_value  trace-length 500)
P;HTML|
;         (set_option_value  trace-on-overtime 4.0)
P;HTML|
;          (set_debug  overtime 4.0)
P;HTML|
;         (set_option_value  trace-on-overflow 1000)
P;HTML|
;          (set_debug  overflow 1000)
P;HTML|
;         (set_option_value  trace-on-eval false)
P;HTML|
;          (set_debug  eval false)
P;HTML|
;         (set_option_value  trace-on-load silent)
P;HTML|
;          (set_debug  load silent)
P;HTML|
;          (set_debug  trace-on-load false)
P;HTML|
;         (set_option_value  trace-on-exec false)
P;HTML|
;          (set_debug  exec false)
P;HTML|
;         (set_option_value  trace-on-error non-type)
P;HTML|
;          (set_debug  error non-type)
P;HTML|
;         (set_option_value  trace-on-fail false)
P;HTML|
;          (set_debug  fail false)
P;HTML|
;         (set_option_value  trace-on-test true)
P;HTML|
;          (set_debug  test true)
P;HTML|
;         (set_option_value  repl-on-error true)
P;HTML|
;         (set_option_value  repl-on-fail false)
P;HTML|
;         (set_option_value  exit-on-fail false)
P;HTML|
;         (set_option_value  repl auto)
P;HTML|
;         (set_option_value  prolog false)
P;HTML|
;         (set_option_value  exec noskip)
P;HTML|
;         (set_option_value  maximum-result-count inf)
P;HTML|
;         (set_option_value  html false)
P;HTML|
;         (set_option_value  python true)
P;HTML|
;         (set_option_value  trace-on-test false)
P;HTML|
;          (set_debug  test false)
P;HTML|
;         (set_option_value  trace-on-fail false)
P;HTML|
;          (set_debug  fail false)
P;HTML|
;         (set_option_value  load show)
P;HTML|
;         (set_option_value  test true)
P;HTML|
;         (maybe_halt  7)
<span class="ansi31"
>(in  (maybe_halt  7) (unwind  (halt  7)))
</span>
Script done on 2024-10-18 04:07:49+00:00 [COMMAND_EXIT_CODE="7"]

</pre>
</body>

</html>
\033[0;32mCompleted successfully (EXITCODE=7) Under 40 seconds: ./mettalog '--output=./reports/tests_output/baseline-compat/' --timeout=40 --html --repl=false  --test "tests/baseline_compat/anti-regression/tmpMatch2.metta" --halt=true\033[0m
